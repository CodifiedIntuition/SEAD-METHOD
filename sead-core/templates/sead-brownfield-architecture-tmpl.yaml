# SEAD Brownfield Architecture Template
template:
  id: sead-brownfield-architecture-template-v1
  name: SEAD Brownfield Enhancement Architecture Document
  version: 1.0
  constitutional_framework: true
  catalog_integration: true
  output:
    format: markdown
    filename: docs/sead-brownfield-architecture.md
    title: "{{project_name}} SEAD Brownfield Enhancement Architecture"

constitutional_requirements:
  mode_detection: required
  catalog_read: mandatory
  context_preservation: enforced
  governance_validation: continuous

workflow:
  mode: constitutional_interactive
  elicitation: sead-advanced-elicitation
  catalog_validation: enabled
  constraint_enforcement: progressive

sections:
  - id: constitutional-introduction
    title: Constitutional Introduction
    instruction: |
      IMPORTANT - CONSTITUTIONAL SCOPE AND ASSESSMENT REQUIRED:

      This constitutional architecture document is for SIGNIFICANT enhancements to existing projects requiring comprehensive architectural planning with governance compliance and catalog integration. Before proceeding:

      1. **Constitutional Complexity Verification**: Confirm this enhancement requires architectural planning with governance validation. For simpler changes, recommend: "For simpler changes that don't require constitutional architectural planning, consider using the sead-brownfield-create-epic or sead-brownfield-create-story task with the Constitutional Product Owner instead."

      2. **CONSTITUTIONAL REQUIRED INPUTS**:
         - Completed sead-brownfield-prd.md with constitutional compliance
         - Existing project technical documentation with catalog pattern references
         - Access to existing project structure with catalog integration assessment
         - Constitutional governance requirements and constraints

      3. **CONSTITUTIONAL DEEP ANALYSIS MANDATE**: You MUST conduct thorough constitutional analysis of existing codebase, architecture patterns, catalog integration, and governance constraints before making ANY architectural recommendations. Every suggestion must be based on actual project analysis with constitutional compliance validation.

      4. **CONSTITUTIONAL CONTINUOUS VALIDATION**: Throughout this process, explicitly validate understanding with constitutional compliance. For every architectural decision, confirm: "Based on my constitutional analysis of your existing system and catalog patterns, I recommend [decision] because [evidence from actual project with governance validation]. Does this align with your system's constitutional requirements?"

      If any constitutional required inputs are missing, request them before proceeding.
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-intro-content
        content: |
          This document outlines the constitutional architectural approach for enhancing {{project_name}} with {{enhancement_description}}. Its primary goal is to serve as the constitutional guiding architectural blueprint for AI-driven development of new features while ensuring seamless integration with existing systems and comprehensive governance compliance.

          **Constitutional Relationship to Existing Architecture:**
          This document supplements existing project architecture by defining how new components will integrate with current systems using SEAD constitutional principles and catalog patterns. Where conflicts arise between new and existing patterns, this document provides constitutional governance guidance on maintaining consistency while implementing governance-compliant enhancements.

          **Catalog Integration Framework:**
          All architectural decisions must reference and contribute to the design-system catalog, ensuring pattern evolution and governance validation across all integration touchpoints.
      - id: constitutional-existing-project-analysis
        title: Constitutional Existing Project Analysis
        instruction: |
          Analyze existing project with constitutional compliance and catalog integration assessment:

          1. Review existing documentation with catalog pattern identification
          2. Examine current technology stack with constitutional compliance validation
          3. Identify existing architectural patterns with governance alignment assessment
          4. Note current deployment with constitutional constraint evaluation
          5. Document constraints with catalog evolution impact analysis

          CONSTITUTIONAL CRITICAL: After analysis, explicitly validate findings: "Based on my constitutional analysis of your project with catalog integration assessment, I've identified the following about your existing system: [key findings with governance implications]. Please confirm these constitutional observations are accurate before I proceed with governance-compliant architectural recommendations."
        elicit: true
        constitutional_validation: required
        sections:
          - id: constitutional-current-state
            title: Constitutional Current Project State
            template: |
              - **Constitutional Primary Purpose:** {{existing_project_purpose}}
              - **Constitutional Current Tech Stack:** {{existing_tech_summary}} (Catalog compliance: {{catalog_compliance_assessment}})
              - **Constitutional Architecture Style:** {{existing_architecture_style}} (Governance validation: {{governance_validation_level}})
              - **Constitutional Deployment Method:** {{existing_deployment_approach}} (Constitutional constraints: {{deployment_constraints}})
              - **Catalog Integration Status:** {{existing_catalog_integration_status}}
              - **Governance Compliance Level:** {{existing_governance_compliance_level}}
          - id: constitutional-available-docs
            title: Constitutional Available Documentation
            instruction: |
              List available documentation with catalog pattern references and governance compliance notes
            type: bullet-list
            template: "- {{existing_docs_summary}} (Catalog patterns: {{catalog_patterns_identified}}, Governance: {{governance_compliance_notes}})"
          - id: constitutional-constraints
            title: Constitutional Identified Constraints
            instruction: |
              Document constraints with catalog evolution and governance impact assessment
            type: bullet-list
            template: "- {{constraint}} (Constitutional impact: {{constitutional_impact}}, Catalog evolution: {{catalog_evolution_impact}})"
      - id: constitutional-changelog
        title: Constitutional Change Log
        type: table
        columns: [Date, Version, Description, Constitutional Impact, Catalog Changes, Governance Validation, Author]
        instruction: Track document versions with constitutional and catalog impact assessment

  - id: constitutional-enhancement-scope
    title: Constitutional Enhancement Scope and Integration Strategy
    instruction: |
      Define constitutional enhancement integration with existing system:

      1. Review SEAD brownfield PRD enhancement scope with governance validation
      2. Identify catalog-compliant integration points with existing code
      3. Define constitutional boundaries between new and existing functionality
      4. Establish governance-validated compatibility requirements
      5. Plan catalog pattern evolution and contribution strategy

      CONSTITUTIONAL VALIDATION CHECKPOINT: Before presenting integration strategy, confirm: "Based on my constitutional analysis, the integration approach I'm proposing takes into account [specific existing system characteristics with catalog patterns]. These constitutional integration points and governance boundaries respect your current architectural patterns and catalog evolution. Is this constitutional assessment accurate?"
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-enhancement-overview
        title: Constitutional Enhancement Overview
        template: |
          **Constitutional Enhancement Type:** {{enhancement_type}}
          **Constitutional Scope:** {{enhancement_scope}} (Governance level: {{governance_scope_level}})
          **Constitutional Integration Impact:** {{integration_impact_level}}
          **Catalog Evolution Contribution:** {{catalog_evolution_contribution}}
          **Governance Validation Requirements:** {{governance_validation_requirements}}
      - id: constitutional-integration-approach
        title: Constitutional Integration Approach
        template: |
          **Constitutional Code Integration Strategy:** {{code_integration_approach}}
          - Catalog pattern alignment: {{catalog_pattern_alignment}}
          - Governance validation touchpoints: {{governance_touchpoints}}

          **Constitutional Database Integration:** {{database_integration_approach}}
          - Data strategy catalog compliance: {{data_strategy_catalog_compliance}}
          - Constitutional data governance: {{constitutional_data_governance}}

          **Constitutional API Integration:** {{api_integration_approach}}
          - API contracts catalog integration: {{api_contracts_catalog_integration}}
          - Constitutional API governance: {{constitutional_api_governance}}

          **Constitutional UI Integration:** {{ui_integration_approach}}
          - Design-system catalog integration: {{design_system_catalog_integration}}
          - Constitutional UI governance: {{constitutional_ui_governance}}
      - id: constitutional-compatibility-requirements
        title: Constitutional Compatibility Requirements
        template: |
          - **Constitutional Existing API Compatibility:** {{api_compatibility}} (Governance validation: {{api_governance_validation}})
          - **Constitutional Database Schema Compatibility:** {{db_compatibility}} (Catalog compliance: {{db_catalog_compliance}})
          - **Constitutional UI/UX Consistency:** {{ui_compatibility}} (Design-system catalog: {{design_system_consistency}})
          - **Constitutional Performance Impact:** {{performance_constraints}} (Governance monitoring: {{governance_performance_monitoring}})
          - **Context Preservation Requirements:** {{context_preservation_requirements}}
          - **Catalog Evolution Validation:** {{catalog_evolution_validation_requirements}}

  - id: constitutional-tech-stack-alignment
    title: Constitutional Tech Stack Alignment
    instruction: |
      Ensure constitutional new components align with existing technology choices and catalog patterns:

      1. Use existing technology stack as constitutional foundation with catalog validation
      2. Only introduce new technologies if constitutionally necessary with governance approval
      3. Justify constitutional additions with clear rationale and catalog evolution benefit
      4. Ensure constitutional version compatibility with catalog constraints
      5. Validate governance compliance for all technology choices
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-stack
        title: Constitutional Existing Technology Stack
        instruction: |
          Document current stack with catalog integration and governance compliance assessment
        type: table
        columns: [Category, Current Technology, Version, Usage in Enhancement, Constitutional Notes, Catalog Integration, Governance Validation]
        instruction: Document the constitutional current stack that must be maintained or integrated with catalog compliance
      - id: constitutional-new-tech-additions
        title: Constitutional New Technology Additions
        condition: Enhancement requires new technologies
        instruction: |
          Document new technologies with constitutional justification and catalog evolution contribution
        type: table
        columns: [Technology, Version, Purpose, Constitutional Rationale, Catalog Integration Method, Governance Validation, Integration Method]
        instruction: Only include if new technologies are constitutionally required for enhancement with governance approval

  - id: constitutional-data-models
    title: Constitutional Data Models and Schema Changes
    instruction: |
      Define constitutional new data models with catalog integration and existing schema compatibility:

      1. Identify new entities required with constitutional governance validation
      2. Define catalog-compliant relationships with existing data models
      3. Plan constitutional database schema changes with governance approval
      4. Ensure constitutional backward compatibility with context preservation
      5. Integrate with data-strategy catalog patterns for consistency
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-new-models
        title: Constitutional New Data Models
        instruction: |
          Define new models with catalog integration and governance compliance
        repeatable: true
        sections:
          - id: constitutional-model
            title: "Constitutional {{model_name}}"
            template: |
              **Constitutional Purpose:** {{model_purpose}}
              **Constitutional Integration:** {{integration_with_existing}}
              **Governance Validation:** {{model_governance_validation}}
              **Catalog Pattern Reference:** {{catalog_pattern_reference}}

              **Constitutional Key Attributes:**
              - {{attribute_1}}: {{type_1}} - {{description_1}} (Governance: {{attr1_governance}}, Catalog: {{attr1_catalog_pattern}})
              - {{attribute_2}}: {{type_2}} - {{description_2}} (Governance: {{attr2_governance}}, Catalog: {{attr2_catalog_pattern}})

              **Constitutional Relationships:**
              - **With Existing:** {{existing_relationships}} (Constitutional validation: {{existing_relationship_governance}})
              - **With New:** {{new_relationships}} (Catalog integration: {{new_relationship_catalog_integration}})
              
              **Context Preservation:** {{model_context_preservation_strategy}}
              **Catalog Evolution Contribution:** {{model_catalog_evolution_contribution}}
      - id: constitutional-schema-integration
        title: Constitutional Schema Integration Strategy
        template: |
          **Constitutional Database Changes Required:**
          - **New Constitutional Tables:** {{new_tables_list}} (Governance: {{tables_governance_validation}})
          - **Constitutional Modified Tables:** {{modified_tables_list}} (Catalog compliance: {{modified_tables_catalog_compliance}})
          - **Constitutional New Indexes:** {{new_indexes_list}} (Performance governance: {{indexes_performance_governance}})
          - **Constitutional Migration Strategy:** {{migration_approach}} (Risk governance: {{migration_risk_governance}})

          **Constitutional Backward Compatibility:**
          - {{compatibility_measure_1}} (Constitutional validation: {{compatibility1_constitutional_validation}})
          - {{compatibility_measure_2}} (Catalog evolution: {{compatibility2_catalog_evolution}})

          **Data Strategy Catalog Integration:**
          - {{data_strategy_catalog_integration_1}}
          - {{data_strategy_catalog_integration_2}}

          **Context Preservation for Data Changes:**
          - {{data_context_preservation_strategy}}

  - id: constitutional-component-architecture
    title: Constitutional Component Architecture
    instruction: |
      Define constitutional new components with catalog integration and existing architecture compatibility:

      1. Identify new components required with constitutional governance validation
      2. Define catalog-compliant interfaces with existing components
      3. Establish constitutional clear boundaries and responsibilities
      4. Plan catalog-integrated integration points and data flow with governance validation
      5. Ensure context preservation across all component interactions

      CONSTITUTIONAL MANDATORY VALIDATION: Before presenting component architecture, confirm: "The constitutional new components I'm proposing follow the existing architectural patterns I identified in your codebase with catalog integration: [specific patterns with governance validation]. The constitutional integration interfaces respect your current component structure and communication patterns with catalog compliance. Does this constitutional match your project's reality with governance requirements?"
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-new-components
        title: Constitutional New Components
        instruction: |
          Define new components with catalog pattern integration and governance compliance
        repeatable: true
        sections:
          - id: constitutional-component
            title: "Constitutional {{component_name}}"
            template: |
              **Constitutional Responsibility:** {{component_description}}
              **Constitutional Integration Points:** {{integration_points}}
              **Governance Validation Level:** {{component_governance_level}}
              **Catalog Pattern Reference:** {{component_catalog_pattern}}

              **Constitutional Key Interfaces:**
              - {{interface_1}} (Governance: {{interface1_governance}}, Catalog: {{interface1_catalog_pattern}})
              - {{interface_2}} (Governance: {{interface2_governance}}, Catalog: {{interface2_catalog_pattern}})

              **Constitutional Dependencies:**
              - **Existing Components:** {{existing_dependencies}} (Constitutional validation: {{existing_deps_constitutional_validation}})
              - **New Components:** {{new_dependencies}} (Catalog integration: {{new_deps_catalog_integration}})

              **Constitutional Technology Stack:** {{component_tech_details}}
              - Catalog compliance: {{component_catalog_compliance}}
              - Governance requirements: {{component_governance_requirements}}
              
              **Context Preservation Strategy:** {{component_context_preservation}}
              **Catalog Evolution Contribution:** {{component_catalog_evolution}}
      - id: constitutional-interaction-diagram
        title: Constitutional Component Interaction Diagram
        instruction: |
          Create Mermaid diagram with catalog pattern references and governance validation points
        type: mermaid
        mermaid_type: graph
        instruction: Create constitutional Mermaid diagram showing how new components interact with existing ones using catalog patterns and governance validation

  - id: constitutional-api-design
    title: Constitutional API Design and Integration
    condition: Enhancement requires API changes
    instruction: |
      Define constitutional new API endpoints with catalog integration and existing API compatibility:

      1. Plan new API endpoints with constitutional governance validation
      2. Ensure catalog-compliant consistency with existing API patterns
      3. Define constitutional authentication and authorization integration
      4. Plan constitutional versioning strategy with catalog evolution support
      5. Integrate with api-contracts catalog patterns for consistency
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-api-strategy
        title: Constitutional API Integration Strategy
        template: |
          **Constitutional API Integration Strategy:** {{api_integration_strategy}}
          **Constitutional Authentication:** {{auth_integration}} (Governance: {{auth_governance_validation}})
          **Constitutional Versioning:** {{versioning_approach}} (Catalog evolution: {{versioning_catalog_evolution}})
          **API Contracts Catalog Integration:** {{api_contracts_catalog_integration}}
          **Constitutional Governance Validation:** {{api_governance_validation_strategy}}
      - id: constitutional-new-endpoints
        title: Constitutional New API Endpoints
        instruction: |
          Define endpoints with catalog pattern integration and governance compliance
        repeatable: true
        sections:
          - id: constitutional-endpoint
            title: "Constitutional {{endpoint_name}}"
            template: |
              - **Constitutional Method:** {{http_method}}
              - **Constitutional Endpoint:** {{endpoint_path}}
              - **Constitutional Purpose:** {{endpoint_purpose}}
              - **Constitutional Integration:** {{integration_with_existing}}
              - **Governance Validation:** {{endpoint_governance_validation}}
              - **Catalog Pattern Reference:** {{endpoint_catalog_pattern}}
              - **Context Preservation:** {{endpoint_context_preservation}}
            sections:
              - id: constitutional-request
                title: Constitutional Request
                type: code
                language: json
                template: |
                  // Constitutional Request Schema
                  // API Contracts Catalog: {{api_contracts_catalog_reference}}
                  // Governance Validation: {{request_governance_validation}}
                  {{request_schema}}
              - id: constitutional-response
                title: Constitutional Response
                type: code
                language: json
                template: |
                  // Constitutional Response Schema
                  // API Contracts Catalog: {{api_contracts_catalog_reference}}
                  // Governance Validation: {{response_governance_validation}}
                  {{response_schema}}

  - id: constitutional-external-api-integration
    title: Constitutional External API Integration
    condition: Enhancement requires new external APIs
    instruction: |
      Document constitutional new external API integrations with governance compliance and catalog pattern alignment
    constitutional_validation: required
    repeatable: true
    sections:
      - id: constitutional-external-api
        title: "Constitutional {{api_name}} API"
        template: |
          - **Constitutional Purpose:** {{api_purpose}}
          - **Constitutional Documentation:** {{api_docs_url}}
          - **Constitutional Base URL:** {{api_base_url}}
          - **Constitutional Authentication:** {{auth_method}} (Governance: {{auth_governance_validation}})
          - **Constitutional Integration Method:** {{integration_approach}}
          - **Catalog Pattern Integration:** {{external_api_catalog_integration}}
          - **Governance Compliance:** {{external_api_governance_compliance}}

          **Constitutional Key Endpoints Used:**
          - `{{method}} {{endpoint_path}}` - {{endpoint_purpose}} (Catalog: {{endpoint_catalog_pattern}})

          **Constitutional Error Handling:** {{error_handling_strategy}}
          - Error handling catalog integration: {{error_handling_catalog_integration}}
          - Constitutional error governance: {{constitutional_error_governance}}

          **Context Preservation for External APIs:** {{external_api_context_preservation}}

  - id: constitutional-source-tree-integration
    title: Constitutional Source Tree Integration
    instruction: |
      Define constitutional integration of new code with existing project structure and catalog organization:

      1. Follow existing project organization with constitutional catalog pattern alignment
      2. Identify constitutional placement for new files/folders with catalog integration
      3. Ensure constitutional consistency with existing naming conventions and catalog patterns
      4. Plan constitutional minimal disruption with governance validation
      5. Organize code to support catalog pattern evolution and context preservation
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-structure
        title: Constitutional Existing Project Structure
        instruction: |
          Document relevant parts of current structure with catalog pattern identification
        type: code
        language: plaintext
        instruction: Document constitutional relevant parts of current structure with catalog integration assessment
        template: |
          // Constitutional Existing Project Structure
          // Catalog Integration Assessment: {{structure_catalog_assessment}}
          // Governance Compliance: {{structure_governance_compliance}}
          {{existing_structure_relevant_parts}}
      - id: constitutional-new-file-organization
        title: Constitutional New File Organization
        instruction: |
          Show constitutional additions with catalog pattern integration and governance compliance
        type: code
        language: plaintext
        instruction: Show constitutional new additions to existing structure with catalog integration
        template: |
          // Constitutional New File Organization
          // Catalog Evolution Contribution: {{file_organization_catalog_evolution}}
          // Governance Validation: {{file_organization_governance_validation}}
          
          {{project-root}}/
          ├── .sead/                              # Constitutional configuration
          │   ├── constitutional-constraints.yaml # Governance constraints
          │   ├── catalog-integration.yaml        # Catalog integration config
          │   └── context-preservation.yaml       # Context preservation settings
          ├── {{existing_structure_context}}
          │   ├── {{new_folder_1}}/              # {{purpose_1}} (Catalog: {{folder1_catalog_pattern}})
          │   │   ├── {{new_file_1}}             # Constitutional implementation
          │   │   └── {{new_file_2}}             # Catalog integration
          │   ├── {{existing_folder}}/           # Existing folder with constitutional additions
          │   │   ├── {{existing_file}}          # Existing file
          │   │   └── {{new_file_3}}            # Constitutional addition (Catalog: {{file3_catalog_pattern}})
          │   └── {{new_folder_2}}/              # {{purpose_2}} (Governance: {{folder2_governance_level}})
      - id: constitutional-integration-guidelines
        title: Constitutional Integration Guidelines
        template: |
          - **Constitutional File Naming:** {{file_naming_consistency}} (Catalog compliance: {{naming_catalog_compliance}})
          - **Constitutional Folder Organization:** {{folder_organization_approach}} (Governance validation: {{folder_governance_validation}})
          - **Constitutional Import/Export Patterns:** {{import_export_consistency}} (Catalog integration: {{import_export_catalog_integration}})
          - **Context Preservation File Organization:** {{context_preservation_file_organization}}
          - **Catalog Evolution File Contribution:** {{catalog_evolution_file_contribution}}

  - id: constitutional-infrastructure-deployment
    title: Constitutional Infrastructure and Deployment Integration
    instruction: |
      Define constitutional enhancement deployment with existing infrastructure and governance compliance:

      1. Use existing deployment pipeline with constitutional governance integration
      2. Identify constitutional infrastructure changes with catalog compliance validation
      3. Plan constitutional deployment strategy with governance risk mitigation
      4. Define constitutional rollback procedures with context preservation
      5. Integrate with deployment-strategy catalog patterns for consistency
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-infrastructure
        title: Constitutional Existing Infrastructure
        template: |
          **Constitutional Current Deployment:** {{existing_deployment_summary}}
          - Governance compliance: {{deployment_governance_compliance}}
          - Catalog integration: {{deployment_catalog_integration}}
          
          **Constitutional Infrastructure Tools:** {{existing_infrastructure_tools}}
          - Constitutional validation: {{infrastructure_constitutional_validation}}
          - Catalog pattern alignment: {{infrastructure_catalog_alignment}}
          
          **Constitutional Environments:** {{existing_environments}}
          - Governance validation per environment: {{environment_governance_validation}}
          - Context preservation across environments: {{environment_context_preservation}}
      - id: constitutional-enhancement-deployment
        title: Constitutional Enhancement Deployment Strategy
        template: |
          **Constitutional Deployment Approach:** {{deployment_approach}}
          - Governance validation gates: {{deployment_governance_gates}}
          - Catalog integration validation: {{deployment_catalog_validation}}
          
          **Constitutional Infrastructure Changes:** {{infrastructure_changes}}
          - Constitutional impact assessment: {{infrastructure_constitutional_impact}}
          - Catalog evolution support: {{infrastructure_catalog_evolution}}
          
          **Constitutional Pipeline Integration:** {{pipeline_integration}}
          - Governance validation stages: {{pipeline_governance_stages}}
          - Context preservation pipeline: {{pipeline_context_preservation}}
      - id: constitutional-rollback-strategy
        title: Constitutional Rollback Strategy
        template: |
          **Constitutional Rollback Method:** {{rollback_method}}
          - Governance compliance during rollback: {{rollback_governance_compliance}}
          - Catalog state preservation: {{rollback_catalog_preservation}}
          
          **Constitutional Risk Mitigation:** {{risk_mitigation}}
          - Constitutional risk assessment: {{constitutional_risk_assessment}}
          - Catalog evolution risk management: {{catalog_evolution_risk_management}}
          
          **Constitutional Monitoring:** {{monitoring_approach}}
          - Governance monitoring integration: {{governance_monitoring_integration}}
          - Context preservation monitoring: {{context_preservation_monitoring}}

  - id: constitutional-coding-standards
    title: Constitutional Coding Standards and Conventions
    instruction: |
      Ensure constitutional new code follows existing project conventions with catalog pattern compliance:

      1. Document constitutional existing coding standards with catalog pattern integration
      2. Identify constitutional enhancement-specific requirements with governance validation
      3. Ensure constitutional consistency with existing codebase patterns and catalog compliance
      4. Define constitutional standards for new code organization with catalog evolution support
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-standards
        title: Constitutional Existing Standards Compliance
        template: |
          **Constitutional Code Style:** {{existing_code_style}}
          - Catalog pattern compliance: {{code_style_catalog_compliance}}
          - Governance validation: {{code_style_governance_validation}}
          
          **Constitutional Linting Rules:** {{existing_linting}}
          - Constitutional linting integration: {{constitutional_linting_integration}}
          - Catalog pattern linting: {{catalog_pattern_linting}}
          
          **Constitutional Testing Patterns:** {{existing_test_patterns}}
          - Test patterns catalog integration: {{test_patterns_catalog_integration}}
          - Governance testing validation: {{governance_testing_validation}}
          
          **Constitutional Documentation Style:** {{existing_doc_style}}
          - Documentation catalog patterns: {{documentation_catalog_patterns}}
          - Constitutional documentation requirements: {{constitutional_documentation_requirements}}
      - id: constitutional-enhancement-standards
        title: Constitutional Enhancement-Specific Standards
        condition: New patterns needed for enhancement
        instruction: |
          Define new patterns with constitutional compliance and catalog integration
        repeatable: true
        template: |
          - **Constitutional {{standard_name}}:** {{standard_description}}
            (Governance: {{standard_governance_level}}, Catalog: {{standard_catalog_integration}})
      - id: constitutional-integration-rules
        title: Constitutional Critical Integration Rules
        template: |
          - **Constitutional Existing API Compatibility:** {{api_compatibility_rule}}
            (Governance validation: {{api_compatibility_governance}})
          - **Constitutional Database Integration:** {{db_integration_rule}}
            (Catalog compliance: {{db_integration_catalog_compliance}})
          - **Constitutional Error Handling:** {{error_handling_integration}}
            (Error handling catalog: {{error_handling_catalog_integration}})
          - **Constitutional Logging Consistency:** {{logging_consistency}}
            (Governance logging: {{governance_logging_requirements}})
          - **Context Preservation Integration:** {{context_preservation_integration_rules}}
          - **Catalog Evolution Integration:** {{catalog_evolution_integration_rules}}

  - id: constitutional-testing-strategy
    title: Constitutional Testing Strategy
    instruction: |
      Define constitutional testing approach with catalog integration and governance validation:

      1. Integrate with constitutional existing test suite and catalog patterns
      2. Ensure constitutional existing functionality remains intact with governance validation
      3. Plan constitutional testing for new features with catalog compliance
      4. Define constitutional integration testing approach with context preservation
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-test-integration
        title: Constitutional Integration with Existing Tests
        template: |
          **Constitutional Existing Test Framework:** {{existing_test_framework}}
          - Governance testing integration: {{governance_testing_integration}}
          - Test patterns catalog compliance: {{test_patterns_catalog_compliance}}
          
          **Constitutional Test Organization:** {{existing_test_organization}}
          - Constitutional test structure: {{constitutional_test_structure}}
          - Catalog integration testing: {{catalog_integration_testing}}
          
          **Constitutional Coverage Requirements:** {{existing_coverage_requirements}}
          - Governance validation coverage: {{governance_validation_coverage}}
          - Context preservation testing coverage: {{context_preservation_coverage}}
      - id: constitutional-new-testing
        title: Constitutional New Testing Requirements
        sections:
          - id: constitutional-unit-tests
            title: Constitutional Unit Tests for New Components
            template: |
              - **Constitutional Framework:** {{test_framework}} (Catalog integration: {{test_framework_catalog_integration}})
              - **Constitutional Location:** {{test_location}} (Governance compliance: {{test_location_governance}})
              - **Constitutional Coverage Target:** {{coverage_target}} (Constitutional validation: {{coverage_constitutional_validation}})
              - **Constitutional Integration with Existing:** {{test_integration}} (Catalog patterns: {{test_integration_catalog_patterns}})
              - **Context Preservation Testing:** {{context_preservation_unit_testing}}
          - id: constitutional-integration-tests
            title: Constitutional Integration Tests
            template: |
              - **Constitutional Scope:** {{integration_test_scope}} (Governance validation: {{integration_governance_validation}})
              - **Constitutional Existing System Verification:** {{existing_system_verification}} (Catalog compliance: {{existing_system_catalog_compliance}})
              - **Constitutional New Feature Testing:** {{new_feature_testing}} (Constitutional validation: {{new_feature_constitutional_validation}})
              - **Catalog Integration Testing:** {{catalog_integration_testing_strategy}}
              - **Context Preservation Integration Testing:** {{context_preservation_integration_testing}}
          - id: constitutional-regression-tests
            title: Constitutional Regression Testing
            template: |
              - **Constitutional Existing Feature Verification:** {{regression_test_approach}} (Governance validation: {{regression_governance_validation}})
              - **Constitutional Automated Regression Suite:** {{automated_regression}} (Catalog compliance: {{regression_catalog_compliance}})
              - **Constitutional Manual Testing Requirements:** {{manual_testing_requirements}} (Constitutional validation: {{manual_constitutional_validation}})
              - **Context Preservation Regression Testing:** {{context_preservation_regression_testing}}
              - **Catalog Evolution Regression Testing:** {{catalog_evolution_regression_testing}}

  - id: constitutional-security-integration
    title: Constitutional Security Integration
    instruction: |
      Ensure constitutional security consistency with existing system and catalog security patterns:

      1. Follow constitutional existing security patterns with catalog security integration
      2. Ensure constitutional new features don't introduce vulnerabilities with governance validation
      3. Maintain constitutional existing security posture with catalog compliance
      4. Define constitutional security testing with context preservation validation
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-existing-security
        title: Constitutional Existing Security Measures
        template: |
          **Constitutional Authentication:** {{existing_auth}}
          - Auth patterns catalog integration: {{auth_patterns_catalog_integration}}
          - Constitutional auth governance: {{constitutional_auth_governance}}
          
          **Constitutional Authorization:** {{existing_authz}}
          - Authorization catalog patterns: {{authorization_catalog_patterns}}
          - Constitutional authorization validation: {{constitutional_authorization_validation}}
          
          **Constitutional Data Protection:** {{existing_data_protection}}
          - Data protection catalog integration: {{data_protection_catalog_integration}}
          - Constitutional data governance: {{constitutional_data_governance}}
          
          **Constitutional Security Tools:** {{existing_security_tools}}
          - Security tools catalog compliance: {{security_tools_catalog_compliance}}
          - Constitutional security validation: {{constitutional_security_validation}}
      - id: constitutional-enhancement-security
        title: Constitutional Enhancement Security Requirements
        template: |
          **Constitutional New Security Measures:** {{new_security_measures}}
          - Security catalog integration: {{security_catalog_integration}}
          - Constitutional security governance: {{constitutional_security_governance}}
          
          **Constitutional Integration Points:** {{security_integration_points}}
          - Security integration catalog patterns: {{security_integration_catalog_patterns}}
          - Constitutional integration validation: {{constitutional_integration_validation}}
          
          **Constitutional Compliance Requirements:** {{compliance_requirements}}
          - Compliance catalog patterns: {{compliance_catalog_patterns}}
          - Constitutional compliance governance: {{constitutional_compliance_governance}}
      - id: constitutional-security-testing
        title: Constitutional Security Testing
        template: |
          **Constitutional Existing Security Tests:** {{existing_security_tests}}
          - Security testing catalog integration: {{security_testing_catalog_integration}}
          - Constitutional security test governance: {{constitutional_security_test_governance}}
          
          **Constitutional New Security Test Requirements:** {{new_security_tests}}
          - New security testing catalog patterns: {{new_security_testing_catalog_patterns}}
          - Constitutional security validation testing: {{constitutional_security_validation_testing}}
          
          **Constitutional Penetration Testing:** {{pentest_requirements}}
          - Pentest catalog integration: {{pentest_catalog_integration}}
          - Constitutional pentest governance: {{constitutional_pentest_governance}}

  - id: constitutional-checklist-results
    title: Constitutional Checklist Results Report
    instruction: |
      Execute constitutional architect-checklist validating:
      - Catalog integration completeness across all domains
      - Constitutional compliance implementation
      - Brownfield integration governance validation
      - Context preservation for agent handoffs
      
      Focus on brownfield-specific constitutional validation with catalog evolution assessment.
    constitutional_validation: mandatory

  - id: constitutional-next-steps
    title: Constitutional Next Steps
    instruction: |
      Define constitutional implementation steps with catalog integration and governance validation:

      1. Constitutional stakeholder review with governance validation of integration points
      2. Constitutional story implementation with catalog-aware Dev agent
      3. Constitutional deployment pipeline integration with governance validation
      4. Constitutional rollback and monitoring procedures with context preservation
    constitutional_validation: required
    sections:
      - id: constitutional-story-manager-handoff
        title: Constitutional Story Manager Handoff
        instruction: |
          Create constitutional brief prompt for Story Manager with catalog integration. Include:
          - Reference to constitutional architecture document with catalog patterns
          - Constitutional integration requirements validated with governance compliance
          - Existing constitutional system constraints based on catalog pattern analysis
          - First constitutional story to implement with catalog integration checkpoints
          - Constitutional emphasis on maintaining existing system integrity with governance validation throughout implementation
        content: |
          **Constitutional Story Manager Handoff:**
          
          Constitutional Story Manager should reference this architecture document for {{project_name}} brownfield enhancement with comprehensive catalog integration and governance compliance.
          
          **Constitutional Key Context:**
          - Architecture document: {{architecture_document_reference}}
          - Constitutional integration requirements: {{constitutional_integration_requirements}}
          - Catalog pattern compliance: {{catalog_pattern_compliance_requirements}}
          - Governance validation level: {{governance_validation_level}}
          - Context preservation requirements: {{context_preservation_requirements}}
          
          **Constitutional Implementation Priority:**
          - First constitutional story: {{first_story_priority}} with catalog integration validation
          - Constitutional integration checkpoints: {{constitutional_integration_checkpoints}}
          - Governance validation gates: {{governance_validation_gates}}
          - Catalog evolution touchpoints: {{catalog_evolution_touchpoints}}
      - id: constitutional-developer-handoff
        title: Constitutional Developer Handoff
        instruction: |
          Create constitutional brief prompt for developers with catalog integration. Include:
          - Reference to constitutional architecture with catalog pattern compliance
          - Constitutional integration requirements with governance validation
          - Constitutional technical decisions with catalog evolution support
          - Constitutional compatibility requirements with context preservation validation
          - Constitutional implementation sequencing with governance risk mitigation
        content: |
          **Constitutional Developer Handoff:**
          
          Constitutional Developers should reference this architecture document and existing coding standards for {{project_name}} brownfield enhancement with comprehensive catalog integration.
          
          **Constitutional Development Context:**
          - Constitutional architecture reference: {{constitutional_architecture_reference}}
          - Existing constitutional coding standards: {{existing_constitutional_coding_standards}}
          - Catalog pattern integration requirements: {{catalog_pattern_integration_requirements}}
          - Constitutional technical decisions: {{constitutional_technical_decisions}}
          - Governance validation requirements: {{governance_validation_requirements}}
          
          **Constitutional Implementation Guidelines:**
          - Constitutional compatibility requirements: {{constitutional_compatibility_requirements}}
          - Catalog integration verification steps: {{catalog_integration_verification_steps}}
          - Constitutional implementation sequencing: {{constitutional_implementation_sequencing}}
          - Governance risk mitigation: {{governance_risk_mitigation}}
          - Context preservation validation: {{context_preservation_validation}}
          - Catalog evolution contribution requirements: {{catalog_evolution_contribution_requirements}}