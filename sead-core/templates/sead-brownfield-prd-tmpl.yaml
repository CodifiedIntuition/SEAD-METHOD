# SEAD Brownfield PRD Template
template:
  id: sead-brownfield-prd-template-v1
  name: SEAD Brownfield Enhancement PRD Document
  version: 1.0
  constitutional_framework: true
  catalog_integration: true
  output:
    format: markdown
    filename: docs/sead-brownfield-prd.md
    title: "{{project_name}} SEAD Brownfield Enhancement PRD"

constitutional_requirements:
  mode_detection: required
  catalog_read: mandatory
  context_preservation: enforced
  governance_validation: continuous

workflow:
  mode: constitutional_interactive
  elicitation: sead-advanced-elicitation
  catalog_validation: enabled
  constraint_enforcement: progressive

sections:
  - id: constitutional-intro-analysis
    title: Constitutional Intro Project Analysis and Context
    instruction: |
      IMPORTANT - CONSTITUTIONAL SCOPE ASSESSMENT REQUIRED:

      This constitutional PRD is for SIGNIFICANT enhancements to existing projects requiring comprehensive planning with governance compliance and catalog integration. Before proceeding:

      1. **Constitutional Enhancement Complexity Assessment**: If this is a simple feature addition or bug fix that could be completed in 1-2 focused constitutional development sessions, STOP and recommend: "For simpler changes, consider using the sead-brownfield-create-epic or sead-brownfield-create-story task with the Constitutional Product Owner instead. This full constitutional PRD process is designed for substantial enhancements requiring constitutional architectural planning and multiple coordinated governance-compliant stories."

      2. **Constitutional Project Context**: Determine if we're working with constitutional governance framework and catalog integration. Analyze existing documentation with catalog pattern identification. If insufficient constitutional documentation exists, recommend running the sead-document-project task first.

      3. **Constitutional Deep Assessment Requirement**: You MUST thoroughly analyze existing project structure, catalog patterns, constitutional constraints, and governance requirements before making ANY suggestions. Every recommendation must be grounded in actual constitutional project analysis with catalog integration validation.

      Gather comprehensive constitutional information about existing project with catalog compliance assessment. This section must be completed before proceeding with constitutional requirements.

      CONSTITUTIONAL CRITICAL: Throughout analysis, explicitly confirm understanding with constitutional validation. For every assumption about existing constitutional project, ask: "Based on my constitutional analysis with catalog integration, I understand that [assumption with governance implications]. Is this constitutional assessment correct?"

      Do not proceed with constitutional recommendations until user has validated understanding of existing constitutional system.
    constitutional_validation: required
    sections:
      - id: constitutional-existing-project-overview
        title: Constitutional Existing Project Overview
        instruction: |
          Check if constitutional document-project analysis was performed with catalog integration. If yes, reference constitutional output with governance validation.
        constitutional_validation: required
        sections:
          - id: constitutional-analysis-source
            title: Constitutional Analysis Source
            instruction: |
              Indicate constitutional analysis source with catalog integration:
              - Constitutional document-project output with catalog patterns available at: {{path}}
              - Constitutional IDE-based fresh analysis with governance validation
              - Constitutional user-provided information with catalog compliance assessment
          - id: constitutional-current-state
            title: Constitutional Current Project State
            instruction: |
              - If constitutional document-project output exists: Extract constitutional summary from "Constitutional High Level Architecture" and "Constitutional Technical Summary" with catalog integration
              - Otherwise: Constitutional brief description with governance compliance assessment of what project currently does and constitutional primary purpose
      - id: constitutional-documentation-analysis
        title: Constitutional Available Documentation Analysis
        instruction: |
          Constitutional documentation assessment with catalog integration:

          If constitutional document-project was run:
          - Note: "Constitutional document-project analysis available with catalog integration - using existing constitutional technical documentation"
          - List constitutional key documents created with catalog pattern references
          - Skip constitutional missing documentation check below

          Otherwise, check for constitutional existing documentation with governance validation:
        constitutional_validation: required
        sections:
          - id: constitutional-available-docs
            title: Constitutional Available Documentation
            instruction: |
              Assess documentation with constitutional compliance and catalog integration
            type: checklist
            items:
              - Constitutional Tech Stack Documentation with Catalog Integration [[LLM: If from constitutional document-project, check ✓]]
              - Constitutional Source Tree/Architecture with Catalog Patterns [[LLM: If from constitutional document-project, check ✓]]
              - Constitutional Coding Standards with Governance Validation [[LLM: If from constitutional document-project, may be partial]]
              - Constitutional API Documentation with Catalog Contracts [[LLM: If from constitutional document-project, check ✓]]
              - Constitutional External API Documentation with Governance Compliance [[LLM: If from constitutional document-project, check ✓]]
              - Constitutional UX/UI Guidelines with Design-System Catalog [[LLM: May not be in constitutional document-project]]
              - Constitutional Technical Debt Documentation with Governance Impact [[LLM: If from constitutional document-project, check ✓]]
              - Constitutional Catalog Integration Documentation [[LLM: Check for catalog pattern documentation]]
              - Constitutional Governance Compliance Documentation [[LLM: Check for governance framework documentation]]
              - "Constitutional Other: {{other_docs}}"
            instruction: |
              - If constitutional document-project was run: "Using existing constitutional project analysis from document-project output with catalog integration."
              - If constitutional critical documentation missing and no document-project: "I recommend running the constitutional sead-document-project task first for comprehensive catalog integration analysis..."
      - id: constitutional-enhancement-scope
        title: Constitutional Enhancement Scope Definition
        instruction: |
          Work with user to clearly define constitutional enhancement type with catalog integration and governance validation. Critical for constitutional scoping and approach.
        constitutional_validation: required
        sections:
          - id: constitutional-enhancement-type
            title: Constitutional Enhancement Type
            instruction: |
              Determine constitutional enhancement type with governance validation and catalog evolution impact
            type: checklist
            instruction: Determine with user which constitutional enhancement applies with catalog integration
            items:
              - Constitutional New Feature Addition with Catalog Integration
              - Constitutional Major Feature Modification with Governance Validation
              - Constitutional Integration with New Systems and Catalog Evolution
              - Constitutional Performance/Scalability Improvements with Governance Monitoring
              - Constitutional UI/UX Overhaul with Design-System Catalog Integration
              - Constitutional Technology Stack Upgrade with Catalog Pattern Migration
              - Constitutional Bug Fix and Stability Improvements with Governance Compliance
              - Constitutional Catalog Pattern Evolution and Governance Enhancement
              - "Constitutional Other: {{other_type}}"
          - id: constitutional-enhancement-description
            title: Constitutional Enhancement Description
            instruction: |
              2-3 sentences describing constitutional enhancement with governance validation and catalog integration impact
          - id: constitutional-impact-assessment
            title: Constitutional Impact Assessment
            instruction: |
              Assess constitutional scope of impact with catalog evolution and governance validation
            type: checklist
            instruction: Assess constitutional scope of impact on existing codebase with catalog integration
            items:
              - Constitutional Minimal Impact (isolated additions with catalog compliance)
              - Constitutional Moderate Impact (some existing code changes with governance validation)
              - Constitutional Significant Impact (substantial existing code changes with catalog evolution)
              - Constitutional Major Impact (architectural changes required with comprehensive governance validation)
      - id: constitutional-goals-context
        title: Constitutional Goals and Background Context
        sections:
          - id: constitutional-goals
            title: Constitutional Goals
            instruction: |
              Constitutional bullet list of governance-validated desired outcomes with catalog integration
            type: bullet-list
            instruction: Constitutional bullet list of 1-line desired outcomes this enhancement will deliver if successful with governance validation and catalog evolution
          - id: constitutional-background
            title: Constitutional Background Context
            instruction: |
              Constitutional context with governance validation and catalog integration rationale
            type: paragraphs
            instruction: 1-2 constitutional short paragraphs explaining why enhancement is needed with governance rationale, what constitutional problem it solves with catalog integration, and how it fits with existing constitutional project and governance framework
      - id: constitutional-changelog
        title: Constitutional Change Log
        type: table
        columns: [Date, Version, Description, Constitutional Impact, Catalog Changes, Governance Validation, Author]

  - id: constitutional-requirements
    title: Constitutional Requirements
    instruction: |
      Draft constitutional functional and non-functional requirements based on validated understanding with catalog integration and governance compliance. Before presenting constitutional requirements, confirm: "These constitutional requirements are based on my understanding of your existing system with catalog integration and governance validation. Please review carefully and confirm they align with your constitutional project's reality and governance framework."
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-functional
        title: Constitutional Functional Requirements
        instruction: |
          Define functional requirements with catalog integration and governance validation
        type: numbered-list
        prefix: CFR
        instruction: Each Constitutional Requirement with identifier starting with CFR and catalog/governance integration
        examples:
          - "CFR1: The existing Todo List will integrate with the new constitutional AI duplicate detection service without breaking current functionality, maintaining design-system catalog patterns and governance validation throughout."
      - id: constitutional-non-functional
        title: Constitutional Non Functional Requirements
        instruction: |
          Define non-functional requirements with governance constraints and catalog compliance
        type: numbered-list
        prefix: CNFR
        instruction: Each Constitutional Non-Functional Requirement with identifier CNFR, including governance constraints and catalog integration
        examples:
          - "CNFR1: Constitutional enhancement must maintain existing performance characteristics with governance monitoring and not exceed current memory usage by more than 20%, while supporting catalog pattern evolution and context preservation for agent handoffs."
      - id: constitutional-compatibility
        title: Constitutional Compatibility Requirements
        instruction: |
          Critical for constitutional brownfield - what must remain compatible with governance validation and catalog integration
        type: numbered-list
        prefix: CCR
        template: "{{requirement}}: {{description}}"
        items:
          - id: ccr1
            template: "CCR1: {{existing_api_compatibility}} with constitutional governance validation and api-contracts catalog compliance"
          - id: ccr2
            template: "CCR2: {{database_schema_compatibility}} with constitutional data governance and data-strategy catalog integration"
          - id: ccr3
            template: "CCR3: {{ui_ux_consistency}} with constitutional design-system catalog integration and governance validation"
          - id: ccr4
            template: "CCR4: {{integration_compatibility}} with constitutional catalog pattern compliance and context preservation"
          - id: ccr5
            template: "CCR5: Context preservation across all constitutional agent handoffs with catalog integration validation"
          - id: ccr6
            template: "CCR6: Catalog pattern evolution contribution with governance compliance validation"

  - id: constitutional-ui-enhancement-goals
    title: Constitutional User Interface Enhancement Goals
    condition: Enhancement includes UI changes
    instruction: |
      For constitutional UI changes, capture integration with existing constitutional UI patterns with design-system catalog integration and governance validation
    constitutional_validation: required
    sections:
      - id: constitutional-existing-ui-integration
        title: Constitutional Integration with Existing UI
        instruction: |
          Describe constitutional integration of new UI elements with existing design patterns, constitutional style guides, design-system catalog components, and governance validation
      - id: constitutional-modified-screens
        title: Constitutional Modified/New Screens and Views
        instruction: |
          List constitutional screens/views that will be modified or added with design-system catalog integration and governance compliance indicators
      - id: constitutional-ui-consistency
        title: Constitutional UI Consistency Requirements
        instruction: |
          Constitutional requirements for maintaining visual and interaction consistency with existing constitutional application, design-system catalog patterns, and governance validation

  - id: constitutional-technical-constraints
    title: Constitutional Technical Constraints and Integration Requirements
    instruction: |
      Constitutional section replaces separate architecture documentation with comprehensive catalog integration. Gather detailed constitutional technical constraints from existing project analysis with governance validation.
    constitutional_validation: required
    sections:
      - id: constitutional-existing-tech-stack
        title: Constitutional Existing Technology Stack
        instruction: |
          Constitutional technology stack with catalog integration assessment:

          If constitutional document-project output available:
          - Extract from "Constitutional Actual Tech Stack" table with catalog compliance assessment
          - Include constitutional version numbers and noted governance constraints

          Otherwise, document constitutional current technology stack with catalog integration:
        template: |
          **Constitutional Languages**: {{languages}} (Catalog compliance: {{languages_catalog_compliance}})
          **Constitutional Frameworks**: {{frameworks}} (Governance validation: {{frameworks_governance_validation}})
          **Constitutional Database**: {{database}} (Data strategy catalog: {{database_catalog_integration}})
          **Constitutional Infrastructure**: {{infrastructure}} (Deployment strategy catalog: {{infrastructure_catalog_integration}})
          **Constitutional External Dependencies**: {{external_dependencies}} (Integration patterns catalog: {{external_deps_catalog_integration}})
          **Constitutional Catalog Integration Status**: {{existing_catalog_integration_status}}
          **Constitutional Governance Compliance Level**: {{existing_governance_compliance_level}}
      - id: constitutional-integration-approach
        title: Constitutional Integration Approach
        instruction: |
          Define constitutional enhancement integration with existing architecture, catalog patterns, and governance validation
        template: |
          **Constitutional Database Integration Strategy**: {{database_integration}}
          - Data strategy catalog compliance: {{database_catalog_compliance}}
          - Constitutional data governance: {{database_governance_validation}}

          **Constitutional API Integration Strategy**: {{api_integration}}
          - API contracts catalog integration: {{api_catalog_integration}}
          - Constitutional API governance: {{api_governance_validation}}

          **Constitutional Frontend Integration Strategy**: {{frontend_integration}}
          - Design-system catalog integration: {{frontend_catalog_integration}}
          - Constitutional UI governance: {{frontend_governance_validation}}

          **Constitutional Testing Integration Strategy**: {{testing_integration}}
          - Test patterns catalog compliance: {{testing_catalog_compliance}}
          - Constitutional testing governance: {{testing_governance_validation}}

          **Constitutional Context Preservation Strategy**: {{context_preservation_integration_strategy}}
          **Constitutional Catalog Evolution Strategy**: {{catalog_evolution_integration_strategy}}
      - id: constitutional-code-organization
        title: Constitutional Code Organization and Standards
        instruction: |
          Based on constitutional existing project analysis with catalog integration, define how constitutional new code will fit existing patterns with governance validation
        template: |
          **Constitutional File Structure Approach**: {{file_structure}}
          - Catalog pattern organization: {{file_structure_catalog_organization}}
          - Constitutional governance compliance: {{file_structure_governance_compliance}}

          **Constitutional Naming Conventions**: {{naming_conventions}}
          - Catalog naming pattern compliance: {{naming_catalog_compliance}}
          - Constitutional naming governance: {{naming_governance_validation}}

          **Constitutional Coding Standards**: {{coding_standards}}
          - Constitutional development standards with catalog integration: {{coding_standards_catalog_integration}}
          - Governance validation requirements: {{coding_standards_governance_validation}}

          **Constitutional Documentation Standards**: {{documentation_standards}}
          - Constitutional documentation with catalog pattern references: {{documentation_catalog_integration}}
          - Context preservation documentation requirements: {{documentation_context_preservation}}
      - id: constitutional-deployment-operations
        title: Constitutional Deployment and Operations
        instruction: |
          Constitutional enhancement integration with existing deployment pipeline, governance validation, and catalog compliance
        template: |
          **Constitutional Build Process Integration**: {{build_integration}}
          - Build process catalog integration: {{build_catalog_integration}}
          - Constitutional build governance: {{build_governance_validation}}

          **Constitutional Deployment Strategy**: {{deployment_strategy}}
          - Deployment strategy catalog compliance: {{deployment_catalog_compliance}}
          - Constitutional deployment governance: {{deployment_governance_validation}}

          **Constitutional Monitoring and Logging**: {{monitoring_logging}}
          - Monitoring governance integration: {{monitoring_governance_integration}}
          - Constitutional logging catalog patterns: {{logging_catalog_patterns}}

          **Constitutional Configuration Management**: {{config_management}}
          - Configuration governance validation: {{config_governance_validation}}
          - Constitutional config catalog integration: {{config_catalog_integration}}
      - id: constitutional-risk-assessment
        title: Constitutional Risk Assessment and Mitigation
        instruction: |
          Constitutional risk assessment with governance validation and catalog evolution impact:

          If constitutional document-project output available:
          - Reference "Constitutional Technical Debt and Known Issues" with governance impact
          - Include "Constitutional Workarounds and Gotchas" affecting enhancement with catalog implications
          - Note constitutional identified constraints from "Constitutional Critical Technical Debt" with governance validation

          Build constitutional risk assessment incorporating existing constitutional known issues with catalog evolution impact:
        template: |
          **Constitutional Technical Risks**: {{technical_risks}}
          - Governance validation risks: {{technical_governance_risks}}
          - Catalog evolution risks: {{technical_catalog_risks}}

          **Constitutional Integration Risks**: {{integration_risks}}
          - Constitutional integration governance risks: {{integration_governance_risks}}
          - Catalog integration risks: {{integration_catalog_risks}}

          **Constitutional Deployment Risks**: {{deployment_risks}}
          - Deployment governance risks: {{deployment_governance_risks}}
          - Constitutional deployment catalog risks: {{deployment_catalog_risks}}

          **Constitutional Mitigation Strategies**: {{mitigation_strategies}}
          - Governance validation mitigation: {{governance_mitigation_strategies}}
          - Catalog evolution mitigation: {{catalog_evolution_mitigation_strategies}}
          - Context preservation risk mitigation: {{context_preservation_mitigation}}

  - id: constitutional-epic-structure
    title: Constitutional Epic and Story Structure
    instruction: |
      For constitutional brownfield projects, favor single comprehensive constitutional epic with catalog integration unless user clearly requests multiple unrelated constitutional enhancements. Before presenting constitutional epic structure, confirm: "Based on my constitutional analysis of your existing project with catalog integration and governance validation, I believe this constitutional enhancement should be structured as [single constitutional epic/multiple constitutional epics] because [rationale based on actual constitutional project analysis with catalog compliance]. Does this align with your constitutional understanding of the work required with governance validation?"
    elicit: true
    constitutional_validation: required
    sections:
      - id: constitutional-epic-approach
        title: Constitutional Epic Approach
        instruction: |
          Explain constitutional rationale for epic structure with catalog integration - typically single constitutional epic for brownfield with governance validation unless multiple unrelated constitutional features
        template: |
          **Constitutional Epic Structure Decision**: {{epic_decision}} with constitutional rationale including catalog integration and governance validation considerations

  - id: constitutional-epic-details
    title: "Constitutional Epic 1: {{enhancement_title}}"
    instruction: |
      Comprehensive constitutional epic delivering brownfield enhancement while maintaining existing functionality with catalog integration and governance validation

      CONSTITUTIONAL CRITICAL STORY SEQUENCING FOR BROWNFIELD:
      - Constitutional stories must ensure existing functionality remains intact with governance validation
      - Each constitutional story should include verification that existing features work with catalog compliance
      - Constitutional stories sequenced to minimize constitutional risk to existing system with governance validation
      - Include constitutional rollback considerations for each story with context preservation
      - Focus on constitutional incremental integration rather than big-bang changes with catalog evolution
      - Size constitutional stories for AI agent execution in existing codebase context with governance compliance
      - CONSTITUTIONAL MANDATORY: Present complete constitutional story sequence and ask: "This constitutional story sequence is designed to minimize risk to your existing system with catalog integration and governance validation. Does this constitutional order make sense given your project's architecture, catalog patterns, and governance constraints?"
      - Constitutional stories must be logically sequential with clear constitutional dependencies identified and catalog integration
      - Each constitutional story must deliver value while maintaining constitutional system integrity with governance validation
    constitutional_validation: required
    template: |
      **Constitutional Epic Goal**: {{epic_goal}}
      - Governance validation: {{epic_governance_validation}}
      - Catalog integration: {{epic_catalog_integration}}

      **Constitutional Integration Requirements**: {{integration_requirements}}
      - Constitutional catalog compliance: {{integration_catalog_compliance}}
      - Governance validation requirements: {{integration_governance_requirements}}
      - Context preservation requirements: {{integration_context_preservation}}
    sections:
      - id: constitutional-story
        title: "Constitutional Story 1.{{story_number}} {{story_title}}"
        instruction: |
          Define constitutional story with catalog integration and governance validation
        repeatable: true
        template: |
          As a {{user_type}},
          I want {{action}} with constitutional governance validation and catalog pattern compliance,
          so that {{benefit}} while maintaining constitutional system integrity and catalog evolution support.
          
          **Constitutional Governance Level**: {{story_governance_level}}
          **Catalog Integration**: {{story_catalog_integration}}
          **Context Preservation**: {{story_context_preservation}}
        sections:
          - id: constitutional-acceptance-criteria
            title: Constitutional Acceptance Criteria
            instruction: |
              Define constitutional criteria including new functionality, existing system integrity, catalog compliance, and governance validation
            type: numbered-list
            instruction: Define constitutional criteria including catalog integration and governance validation
            item_template: "{{criterion_number}}: {{criteria}} (Governance: {{criterion_governance}}, Catalog: {{criterion_catalog}})"
          - id: constitutional-integration-verification
            title: Constitutional Integration Verification
            instruction: |
              Constitutional verification steps ensuring existing functionality remains intact with catalog compliance and governance validation
            type: numbered-list
            prefix: CIV
            items:
              - template: "CIV1: {{existing_functionality_verification}} with constitutional governance validation and catalog pattern compliance"
              - template: "CIV2: {{integration_point_verification}} with constitutional catalog integration validation and governance compliance"
              - template: "CIV3: {{performance_impact_verification}} with constitutional performance governance and catalog optimization validation"
              - template: "CIV4: Context preservation validation across all constitutional agent handoffs with catalog integration verification"
              - template: "CIV5: Catalog pattern evolution contribution validation with constitutional governance compliance"